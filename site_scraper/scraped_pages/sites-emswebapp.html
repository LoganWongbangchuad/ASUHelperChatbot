


<!DOCTYPE HTML>
<html xmlns:wairole="http://www.w3.org/2005/01/wai-rdf/GUIRoleTaxonomy#"
    lang="en"
xmlns:waistate="http://www.w3.org/2005/07/aaa">
<head id="Head1"><meta http-equiv="X-UA-Compatible" content="IE=edge" /><meta http-equiv="CACHE-CONTROL" content="NO-CACHE" /><meta http-equiv="Pragma" content="no-cache" /><meta http-equiv="Content-Language" content="en" /><meta name="viewport" content="width=device-width, user-scalable=1, initial-scale=1.0" /><title>
	Home / EMS
</title><link rel="icon" href="favicon.ico" type="image/x-icon" /><link rel="shortcut icon" href="ShortcutIcon.ico" type="image/x-icon" /><link rel="apple-touch-icon" href="Images/ems-app-icon.png" /><link href="/EmsWebApp/Content/font-open-sans?v=_JI6F_d6ODXWsWOBq3KYfHe6xZboO-vokTM57OfrfC01" rel="stylesheet"/>
<link href="/EmsWebApp/Content/font-awesome?v=5AwHtUzQR-rmc_u33Jb9uS0RExSIuDWg2lTDFA9AxZw1" rel="stylesheet"/>
<link href="/EmsWebApp/Content/dx?v=Z_-0nTVzD1gMOrp3Hxf7skl0m8xgR9awkrdjuWeXaLQ1" rel="stylesheet"/>
<link href="/EmsWebApp/Content/perfect-scrollbar?v=B8bG5WKr3gBsDd-E1OWrwqyyncxJgsbxtqGi4sbwl0Q1" rel="stylesheet"/>
<link href="/EmsWebApp/Content/core?v=Fl_Fnog4Rmu2RVtRQrAKuqkllc8y9D6C76t40CjUH-E1" rel="stylesheet"/>
<link href="/EmsWebApp/Content/plugins?v=rQgjWPBV-C-v1uAMB0dyrVETn3GmdP4qz5HASrUbO1I1" rel="stylesheet"/>
<link href="Content/jHtmlArea.css" rel="stylesheet" /><link href="Content/jqueryui.1.12.1/jquery-ui.min.css" rel="stylesheet" />
    <style>
        #page-title {
            width: 50%;
        }

            #page-title h1 {
                overflow: hidden;
                -ms-text-overflow: ellipsis;
                -o-text-overflow: ellipsis;
                text-overflow: ellipsis;
                white-space: nowrap;
                width: 100%;
            }

        .date-picker-today-btn::after {
            content: "Today";
        }
    </style>
    <link href="/EmsWebApp/Content/login.css" rel="stylesheet"/>
<link href="/EmsWebApp/Content/Custom/Custom.css" rel="stylesheet"/>
<script src="/EmsWebApp/bundles/moment?v=rnZhZNZW9cPeDdG7Hnfpo91F_THtue8iw8aGWRUkouo1"></script>
<script src="/EmsWebApp/bundles/jquery?v=mQPEZY0YS95ygaQCIjoqJzdThN4VdQJ36wLEgOtEk2w1"></script>
<script src="/EmsWebApp/bundles/jquery-plugins?v=fE9nMtkh07rzv1WGcXR2WpPpz0S1019dwbkbKzTiAgU1"></script>
<script src="/EmsWebApp/bundles/bootstrap?v=NSwrfBSYM4zamiK663clFf10u2-xwneCNQYDQSHMo9w1"></script>
<script src="/EmsWebApp/bundles/knockout?v=VwAYhIqPC1hCrw3HDTVLb18k6mH7RXL-i9vYWTRAWf01"></script>
<script src="/EmsWebApp/bundles/perfect-scrollbar?v=mzl4eUqhZA3z8ih_WxOJqnwT2POseuhEArr2hrsP4Uc1"></script>
<script src="/EmsWebApp/bundles/dx-dependencies?v=Px4kGcg0i_FVAWN7AGzP60AOh9IL7CQG48R5L3Um1YY1"></script>
<script src="/EmsWebApp/bundles/dx?v=Jil6Id3D24DTwlMYGMvP0RiuM4bD-kHNRJmqYvKvruY1"></script>
<script src="/EmsWebApp/bundles/touche?v=lSzdvQTsAgRAphGWrI1Q5FPa6x0j83lThZhAnooKtvI1"></script>
<script src="/EmsWebApp/bundles/hammer?v=8MhTLgJ4vxm1iJzGbwZ45lU4kQvp3riTYeLBfZ4eAxk1"></script>
<script src="/EmsWebApp/bundles/bleach?v=37G4ObD99h6iPTAB2kWXJFKWv9U8YzGbMsFA_gVgpPE1"></script>
<script src="/EmsWebApp/bundles/vems?v=yd5Nj-xqQIQtJd1ZfjmJwp-5oha89Agka7AsU2XWzi01"></script>
<script src="/EmsWebApp/bundles/vems-plugins?v=NyiQHrsBzDdlwpB37OUkj6DwJpxAvaym7hLUnnL3tC81"></script>

    <link href="/EmsWebApp/Content/leaflet?v=AuW594tDBiJM0cBMh4KzqEV_FxOZ1Og9ifqhM54TfPo1" rel="stylesheet"/>

    <script src="/EmsWebApp/bundles/leaflet?v=Mfkgra1UThQasPYVCi7dIJJiWBTT3OgNgLKsMf114uE1"></script>

    <script src="/EmsWebApp/bundles/home?v=jpk6Anxe-SbHslC016azmKDQ_mezqxfur1d9nmR_h2k1"></script>

    <link href="/EmsWebApp/Content/calendar-scroller?v=3fu3p2AVT3umGBzBh0QZwA1E49SuXC-ajTJtiVGcPCo1" rel="stylesheet"/>

    <style>
        #page-title-responsive h1 {
            float: left;
        }

        #new-booking {
            float: right;
            line-height: 2.5em;
        }

        .calendar-scroller-container .calendar-scroller-cal {
            height: 60px;
        }

        .calendar-cell-container {
            height: 50px !important;
        }
    </style>
</head>

<body>

    <form method="post" action="./Default.aspx?data=5BtDNigiZmYcBDtEfk61NA%3d%3d" id="VirtualEmsForm">
<input type="hidden" name="deaCSRFToken" id="deaCSRFToken" value="3c78f4e8-3430-475c-9f23-6b17d82fab13" />
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="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" />


<script type="text/javascript">
//<![CDATA[
vems.todaysEventsForUser = {"NextBookingDate":null,"EventData":null,"UserTimeZone":null,"UserTimeZoneAbbr":null};Dea.eventsForMonth = {"NextBookingDate":null,"EventData":null,"UserTimeZone":null,"UserTimeZoneAbbr":null};Dea.loginOverrideUrl = '';var vems = vems || {}; vems.userLanguage = "en";vems.cancelReasons = [{"Id":2,"Reason":"At Customer Request","RequireNotes":false},{"Id":1,"Reason":"Cancelled in Banner","RequireNotes":false},{"Id":3,"Reason":"Denied","RequireNotes":false}];vems.hasBrowseForSpace = 1;vems.enableSocialMedia = 1;var ems_Help = "Help",ems_timeSep = ":",ems_AM = "AM",ems_PM = "PM",ems_timeFormat = "h:mm tt",ems_timePicker = "Time Picker",ems_useHelpIcon = 1,ems_UnhandledCallback = "Unhandled Callback.",ems_FailedToLoadCallbackXml = "Error loading XML document from server",ems_NoItemSelected = "You must select an item first",ems_InvalidTime = "Invalid Time",ems_FirstDateViolation = "Your booking date violates the first date allowed.",ems_LastDateViolation = "Your booking date violates the late date allowed.",ems_InvalidDate = "Invalid Date",ems_CloseTheCalendar = "Close the Calendar",ems_LocDetails = "Location Details",ems_ResourceDetails = "Resource Details",ems_BookingDetails = "Booking Details",ems_ResDetails = "Reservation Details",ems_cookieHash = "deaConnection",deaCSRFTokenField = "deaCSRFToken",ems_MultipleHolidaysLabel = "Multiple Holidays",sSelectedColor = "rgb(255,255,255)";vems.isAuthed = false;vems.is24HrFormat = false;vems.maxInputLength = 0;Dea.checkVersion("data=dkSv93%2bpBZlRCdJ%2bkAGvug%3d%3d");Dea.pageCallback = function (emsObject) { WebForm_DoCallback('__Page','' + Dea.JSON.stringify(emsObject) + '',Dea.handleCallback,'' + emsObject.router + '',Dea.errorCallback,true)};var PathToRoot = '/EmsWebApp/',ems_PauseToLoadMsg = "Pause to load tool tip",ems_Loading = "Loading...",ems_sessionMilli=1200000,ems_timeOutUrl="Logout.aspx";//]]>
</script>

<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="F3F08249" />
<input type="hidden" name="__VIEWSTATEENCRYPTED" id="__VIEWSTATEENCRYPTED" value="" />
<input type="hidden" name="__EVENTVALIDATION" id="__EVENTVALIDATION" value="ZEihViycwyfNKsb+2qVReddWoirIt1AHcCXkRLxMy8KBE9DgXDtFT1kTCsZasLdrRC/wFo/72mQF7SpGIlV+MXPO6i5nxu07p1kbvhVnxwF2XejhX4wRB0lRspNLDkYCl44XhqNWby5GBrZjwGkeGA==" />
        <div id="showMobile" class="hidden" style="vertical-align: middle; text-align: center; position: fixed; top: 0; left: 0; right: 0; width: auto; height: 80px; background-color: #F1F1F1; z-index: 998;">
            <div class="container-fluid" style:"margin: auto; vertical-align: center;">
                <div class="center-block" style="min-height: 100%; display: flex; align-items: center; vertical-align: middle; margin: auto;">
                    <a id="dismissMobile" class="alert-link" style="vertical-align: middle; text-align: left; margin-right: 10px;">
                        <h3 style="color: #929292;">
                            <label for="dismiss-mobile-close" class="hide-element">Close</label>
                            <i id="dismiss-mobile-close" class="fa fa-close"></i>
                        </h3>
                    </a>
                    <img src="Images/ems-app-icon.png" alt="logo" style="max-width: 50px; height: auto; display: inline-block; text-align: right; vertical-align: middle;">
                    <div class="col-xs-6" style="display: inline-block; vertical-align: middle;  text-align: left;">
                        <h4>EMS Mobile App</h4>
                    </div>
                    <a id="launchMobile" class="intent alert-link" style="display: inline-block; vertical-align: middle; text-align: left; margin: 10px;" data-scheme="emssoftware://">
                        <h3 style="color: #007AFF">Open</h3>
                    </a>
                </div>
            </div>
        </div>
        <div id="page-loading-overlay" style="display: none;">
            <img class="loading-animation" src="Images/Loading.gif" alt="Loading..." />
        </div>
        <h1 id="ApplicationTitle" class="ApplicationTitle hide">
	Virtual EMS
</h1>
        <nav id="vems-navbar-top" class="navbar navbar-default navbar-fixed-top">
            <div class="container-fluid">
                <div id="nav-logo-section" class="navbar-header">
                    <button type="button" class="navbar-toggle collapsed" onclick="vems.toggleSideBar();">
                        <span class="sr-only">Toggle navigation</span>
                        <i class="fa fa-navicon"></i>
                    </button>
                    <div class="navbar-brand">
                        <a class="ems-logo-link" href="./">
                            <img src="Images/customlogo.png" class="ems-logo" alt="EMS" title="EMS">
                        </a>
                    </div>
                </div>

                <div id="page-title" class="navbar-header">
                    <h1>Virtual EMS</h1>
                </div>

                <div id="user-menu-section" class="navbar-collapse">
                    <ul class="nav navbar-nav navbar-right">
                        <li id="help-icon" class="help-icon dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false" aria-label="Help"><i class="fa fa-question-circle"></i></a>
                            <ul class="dropdown-menu">
                                <!-- ko foreach: helpMenuItems -->
                                <li><a data-bind="text: vems.decodeHtml(Text), attr: {'href': NavigateUrl}, click: $root.menuItemClicked"></a></li>
                                <!-- /ko -->

                                <!-- ko if: customHelpMenuItems().length > 0 -->
                                <li class="divider" role="separator"></li>
                                <!-- ko foreach: customHelpMenuItems -->
                                <li><a data-bind="text: vems.decodeHtml(Text), attr: {'href': NavigateUrl}, click: $root.menuItemClicked"></a></li>
                                <!-- /ko -->
                                <!-- /ko -->
                            </ul>
                        </li>

                        <li class="dropdown" id="user-menu">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
                                <div id="user-name-icons">
                                    <i class="fa fa-user"></i>
                                    
                                </div>
                                <div id="user-name" class="ellipsis-text">
                                    Welcome, Guest.
                                    
                                </div>
                            </a>
                            <ul class="dropdown-menu" id="user-menu-dropdown" data-bind="visible: showGuestUserMenu || (showAuthUserMenu && userMenuItems().length > 0)">
                                <!-- ko if: showAuthUserMenu -->
                                <!-- ko foreach: userMenuItems -->
                                <!-- ko ifnot: Id === -48 -->
                                <li><a data-bind="text: vems.decodeHtml(Text), attr: {'href': NavigateUrl}, click: $root.menuItemClicked"></a></li>
                                <!-- /ko -->
                                <!-- ko if: Id === -48 && showActAs -->
                                <li><a data-bind="text: vems.decodeHtml(Text), attr: {'href': '#'}" data-toggle="modal" data-target="#actas-modal"></a></li>
                                <!-- /ko -->
                                <!-- /ko -->

                                <!-- ko if: DevExpress.devices.real().phone -->
                                <li role="separator" class="divider"></li>
                                <!-- ko foreach: helpMenuItems -->
                                <li><a data-bind="text: vems.decodeHtml(Text), attr: {'href': NavigateUrl}, click: $root.menuItemClicked"></a></li>
                                <!-- /ko -->
                                <!-- /ko -->

                                <li role="separator" class="divider"></li>
                                <!-- ko foreach: adminMenuItems -->
                                <li><a data-bind="text: vems.decodeHtml(Text), attr: {'href': NavigateUrl}, click: $root.menuItemClicked"></a></li>
                                <!-- /ko -->
                                <!-- ko foreach: signOutMenuItems -->
                                <li class="sign-out">
                                    <a data-bind="html: '<i class=\'fa fa-sign-out\'></i>&nbsp;' + vems.decodeHtml(Text), attr: {'href': NavigateUrl}"></a>
                                </li>
                                <!-- /ko -->
                                <!-- /ko -->

                                <!-- ko if: showGuestUserMenu && !showAuthUserMenu -->
                                <li><a href="Default.aspx?data=5BtDNigiZmYcBDtEfk61NA%3d%3d">Sign In</a></li>
                                <!-- /ko -->
                            </ul>
                        </li>
                    </ul>
                </div>
                <!-- /.navbar-collapse -->
            </div>
            <!-- /.container-fluid -->
        </nav>
        <div id="wrapper">

            <!-- Sidebar -->
            <div id="sidebar-wrapper">
                <ul class="sidebar-nav" data-bind="foreach: mainMenuItems">
                    <!-- HR before the Links menu -->
                    <!-- ko if: Id == 4  -->
                    <li>
                        <hr />
                    </li>
                    <!-- /ko -->

                    <!-- hide My Events on Mobile Web -->
                    <!-- ko ifnot: DevExpress.devices.real().phone && Id === 9 -->
                    <li data-bind="css: { 'no-click': NavigateUrl.length == 0 }">
                        <a data-bind="css: { 'current-page': $root.OnMenuItemPage(NavigateUrl) }, attr: {'href': NavigateUrl.length > 0 ? NavigateUrl : '#', 'title': vems.decodeHtml(Text)}, click: $root.menuItemClicked">
                            <i class="fa" data-bind="css: IconClass"></i>
                            <span data-bind="text: vems.decodeHtml(Text)"></span>
                        </a>
                    </li>

                    <div data-bind="foreach: ChildMenus">
                        <li class="secondary" data-bind='css: { "resource-link": $parent.Id == 4 }'>
                            <a data-bind="css: { 'current-page': $root.OnMenuItemPage(NavigateUrl) }, attr: {'href': NavigateUrl, 'title': vems.decodeHtml(Text)}, click: $root.menuItemClicked">
                                <i class="fa" data-bind="css: IconClass"></i>
                                <span data-bind="text: vems.decodeHtml(Text)"></span>
                            </a>
                        </li>
                    </div>
                    <!-- /ko -->
                </ul>
            </div>
            <!-- end sidebar-wrapper -->

            <div id="page-content-wrapper">
                <div class="container-fluid main-content" id="page">

                    <div id="page-title-responsive">
                        <h1>Virtual EMS</h1>
                    </div>

                    

                    <div id="helpDialog" style="display: none;">
                        <div id="DefaultHelp" class="clear">
	
</div>
                    </div>
                    
    <span style="display: none">
        <h1 id="pc_ApplicationTitle" class="ApplicationTitle">
	Virtual EMS
</h1>
    </span>
    <div id="home" style="height: 100%;">
        
        <ul id="default-tablist" class="nav nav-tabs" role="tablist">
            <li role="presentation" id="site-home-tab"><a href="#site-home" data-toggle="tab" role="tab">Site Home</a></li>
            <li role="presentation" id="my-home-tab"><a href="#my-home" data-toggle="tab" role="tab">My Home</a></li>
            
            
        </ul>

        <!-- Tab panes -->
        <div class="tab-content">
            <div role="tabpanel" class="tab-pane fade" id="site-home"> 
                <div class="default-page-help-text">
                    <div id="pc_HomeHelp" class="default-page-help-text-content">
	<h1>WELCOME! </h1>Please log in to access advanced features of the web site. If you are experiencing difficulty using this site, please click here or select the Help icon for more information.
</div>   
                </div>
            </div>
            <div role="tabpanel" class="tab-pane fade" id="my-home">

                <div id="conf-msg" style="display:none;">
                    <div data-bind="visible: false">
                        <h1 class="confirm-head">Sign Up Complete</h1>
                        <div class="confirm-row">Congratulations! You have successfully signed up to use EMS! Sign in below.</div>
                    </div>
                    <div data-bind="visible: false">
                        <h1 class="confirm-head">Your Password Has Been Reset</h1>
                        <div class="confirm-row">Success, you can sign in below using your new password! A confirmation email regarding the password reset has been sent to .</div>
                    </div>
                </div>

                <div class="container-fluid vems-panel" id="signin-panel" style="display: none;">
                    <div class="row">
                        <div class="col-md-6 left-subpanel" data-bind="visible: AllowSignIn" style="display: none;">
                            <h4>Sign In</h4>
                            <div id="login" style="height:100%">
                                <div class="clear">
                                    <div id="pc_WebText1">
	
</div>
                                </div>
                                <div class="loginDiv">
                                    <div id="timeoutMsg" class="timeout-message center-block" style="display: none;">
                                        <span class="fa fa-exclamation-circle timeout-icon"></span>
                                        <span>Your session has expired, and you have been logged out.<br />Please log in again to continue.</span>
                                    </div>                                
                                    <div id="login-standard-div" class="center-block" style="width: 60%; display: none;">
                                        <div class="form-group">
                                            <label for="userID_input" class="required">User Id</label>                                        
                                            <input name="ctl00$pc$userID_input" type="text" maxlength="300" id="userID_input" class="userId form-control" required="required" />
                                        </div>
                                        <div class="form-group">
                                            <label for="password_input" class="required">Password</label>
                                            
                                            <label for="pwd-hidden-ie" style="display:none;" aria-hidden="true">Password</label>
                                            <input id="pwd-hidden-ie" type="password" style="display:none;" maxlength="255" aria-hidden="true" readonly />
                                            
                                            <input type="password" class="form-control" id="password_input" required="required" name="password_input" autocomplete="new-password" maxlength="255" />
                                            <input type="hidden" id="pwdhid" name="pwdhid" />
                                        </div>
                                        

                                        <div class="validation-error-message" style="margin-bottom: 10px"></div>

                                        <div class="form group text-left" >
                                            <input type="submit" name="ctl00$pc$btnLogin" value="Sign In" id="pc_btnLogin" class="btn btn-primary" />
                                        </div>
                                        <div id="pc_forgotPasswordContainer" class="form-group text-left" style="margin-top: 15px;"> 
                                            <a href="ForgotPassword.aspx"><i class="fa fa-exclamation-triangle fa-3"></i> I've forgotten my password.</a>
                                        </div>
                                    </div>
                                    <div id="login-sso-div" class="center-block" style="display: none;">
                                        <div class="text-center">
                                            <button type="button" class="btn btn-primary" onclick="window.location = Dea.loginOverrideUrl">Sign In</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6" id="guest-actions" data-bind="visible: (ShowCreateAccountButton() || AllowUnauthenticatedRequest())" style=" display: none; vertical-align: middle">
                            <div>
                                <h4>Welcome, Guest.</h4>
                            </div>
                            <div id="create-acct" class="text-center" style="margin-top: 1em;" data-bind="visible: ShowCreateAccountButton">
                                <a class="btn btn-success" type="button" href="AccountManagement.aspx" data-bind="html: AccountButtonText"></a>
                            </div>
                            <div id="create-request-unauth" class="text-center" style="margin-top: 1em;" data-bind="visible: AllowUnauthenticatedRequest">
                                <a class="btn btn-success" type="button" href="/EmsWebApp/ClassicRequestForm.aspx?data=ity3Dem%2byxxGFZTQvNr975K4dCU8QwV7" data-bind="html: RequestRoomText"></a>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="my-home-content" style="display: none;">
                    <!-- My Reservation Templates -->
                    <div id="my-reservation-templates" class="hidden-xs">
                        <h2>My Reservation Templates</h2>
                        <div>
                            <div id="templates-no-results" class="no-bookings-wrap" style="display: none;">
                                 <h3>You have no templates configured.</h3>
                             </div>
                            <div id="templates-grid" class="booking-grid daily col-xs-12">
                                <div data-bind="template: { name: 'my-reservation-templates-template', foreach: templates }"></div>
                            </div>
                        </div>
                    </div>

                    <!-- My Reservations -->
                    <div id="my-reservations">
                        <h2>My Bookings</h2>
                        <div id="my-reservations-content" class="home-my-reservations-content">
                            <div id="my-reservations-overlay" class="home-my-reservations-overlay">
                                <button id="btn-show-my-reservations" role="button" class="btn btn-primary" data-bind="click: hideShowMyBookingsButton">Show My Bookings</button>
                            </div>
                            <ul class="nav nav-tabs" role="tablist" id="my-bookings-main-tabs">
                                <li id="my-bookings-title" role="presentation" class="active"><a href="#my-bookings" data-toggle="tab" role="tab" data-bind="text: localeDate()"></a></li>
                                <li id="my-bookings-search-tab" role="presentation"><a href="#my-bookings-search" data-toggle="tab" role="tab">Search</a></li>
                                <span class="time-zone-heading" data-bind="text: vems.decodeHtml(userTimeZone()) + (userTimeZoneAbbr() ? ' [' + userTimeZoneAbbr() + ']' : '')"></span>
                            </ul>
                            <div class="tab-content">
                                <div role="tabpanel" class="tab-pane fade in active" id="my-bookings">
                                    <div class="events-loading-overlay"><img class="loading-animation" src="Images/Loading.gif" alt="Loading..."/></div>
                                    <div class="text-center">
                                        <div class="row bordered">
                                            <div class="text-center">
                                                <div id="sliderContainer"></div>
                                            </div>
                                        </div>
                                        <ul id="my-bookings-tabs" class="nav nav-pills center-pills">
                                            <li role="presentation" class="active" data-tabtype="day"><a href="#my-bookings-daily" data-toggle="tab" role="tab" title="Day">Day</a></li>
                                            <li role="presentation" data-tabtype="month"><a href="#my-bookings-monthly" data-toggle="tab" role="tab" title="Month">Month</a></li>
                                            <li role="presentation" data-tabtype="search">
                                                <div class="date input-group" id="my-bookings-datepicker">
                                                    <label for="hidden-date-input" style="display: none;">Date</label>
                                                    <input id="hidden-date-input" type="text" maxlength="255" readonly />
                                                    <a class="input-group-addon" tabindex="0" title="Date">
                                                        <div>
                                                            Date&nbsp;
                                                            <i class="fa fa-angle-down"></i>
                                                        </div>
                                                    </a>
                                                </div>
                                            </li>
                                        </ul>
		                        
                                        <div class="previous-today-next pull-right">
                                            <a class="hidden-sm hidden-xs" data-bind="click: previousTodayNextHandler.bind($data, -1), event: {
                                                keyup: function (data, e) { if (e.which == 13) { previousTodayNextHandler(-1); } } }" tabindex="0" title="Previous">
                                                Previous
                                            </a>
                                            <a class="hidden-md hidden-lg fa fa-chevron-left" data-bind="click: previousTodayNextHandler.bind($data, -1), event: {
                                                keyup: function (data, e) { if (e.which == 13) { previousTodayNextHandler(-1); } } }" tabindex="0"></a>
                                            <a data-bind="click: previousTodayNextHandler.bind($data, 0), event: {
                                                keyup: function (data, e) { if (e.which == 13) { previousTodayNextHandler(0); } } }" tabindex="0" title="Today">
                                                Today
                                            </a>
                                            <a class="hidden-sm hidden-xs" data-bind="click: previousTodayNextHandler.bind($data, 1), event: {
                                                keyup: function (data, e) { if (e.which == 13) { previousTodayNextHandler(1); } } }" tabindex="0" title="Next">
                                                Next
                                            </a>
                                            <a class="hidden-md hidden-lg fa fa-chevron-right" data-bind="click: previousTodayNextHandler.bind($data, 1), event: {
                                                keyup: function (data, e) { if (e.which == 13) { previousTodayNextHandler(1); } } }" tabindex="0"></a>
                                        </div>
                                    </div>

                                    <div class="tab-content">
                                        <div role="tabpanel" class="tab-pane fade in active" id="my-bookings-daily" style="position:relative;">
                                            <!-- ko if: gettingEventsForDay() -->
                                            <div class="my-bookings-loading">
                                                <img class="my-bookings-loading-img" src="Images/Loading.gif" alt="Loading..." />
                                            </div>
                                            <!-- /ko -->
                                            <!-- ko if: events().length > 0 -->
                                            <div class="booking-grid daily col-xs-12">
                                                <div data-bind="template: { name: 'my-bookings-template', foreach: events, as: 'ev' }">
                                                </div>
                                            </div>
                                            <!-- /ko -->
                                            <!-- ko if: events().length == 0 -->
                                            <div id="no-bookings-wrap" class="no-bookings-wrap">
                                                <h3 data-bind="text: vems.decodeHtml(vems.noBookingsForDate.replace('{0}', localeDate()))"></h3>
                                                <h4 data-bind="visible: nextBookingDate() !== null, click: getEventsForDay.bind($data, nextBookingDate())">
                                                    <a><i class="fa fa-external-link-square"></i>Take me to the next day containing bookings.</a>
                                                </h4>
                                            </div>
                                            <!-- /ko -->
                                        </div>
                                        <div role="tabpanel" class="tab-pane fade" id="my-bookings-monthly">
                                            <div id="bookings-monthly-calendar"></div>
                                        </div>
                                    </div>
                                </div>
                                <div role="tabpanel" class="tab-pane fade" id="my-bookings-search">
                                    <!-- Simple search -->
                                    <div class="form-inline simple-search">
		                                <div class="form-group">
                                            <label class="hide-element" for="booking-search-box">Search for bookings by name or location.</label>
			                                <input type="text" class="form-control" id="booking-search-box" maxlength="255">
		                                </div>
	
		                                <button type="button" class="btn btn-default" id="booking-search-button" data-bind="click: $root.searchForBookings">Search</button>
                                        <span id="booking-search-count" class="result-count" style="display: none;" data-bind="text: searchRecordCountLabel"></span>
		                        
                                        <!-- ko if: searchRecordCount() == 20 && !DevExpress.devices.real().phone -->
		                                <span>&nbsp;Want to see more? Continue searching in <a href="BrowseReservations.aspx">Manage My Reservations</a>.</span>
                                        <!-- /ko -->
	                                </div>

                                    <div class="simple-search-results">
                                        <p class="inline-instructions" id="booking-search-instructions">Search for bookings by name or location.</p>
                                        <div id="booking-no-results" class="col-md-offset-4" style="display: none;">
                                            
                                            <h3 id="booking-no-results-head">Nothing was found for "".</h3>
                                            <ul>
                                                <li>Start with a simple search; use less text.</li>
                                                <li>Remember, only booking title and location are searchable.</li>
                                            </ul>
                                        </div>
                                        <div id="booking-search-results" class="booking-grid daily col-xs-12" style="display: none;" data-bind="component: { name: 'booking-search-component', params: $root }">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div data-bind='component: {name: "cancel-reason-dialog", params: $root}'></div>
                        </div>
                    </div>

                    <!-- Infographics -->
                    <div id="my-infographics" class="hidden-xs" style="display:none;">
                        <h2>My Infographics</h2>
                        <div class="row">
                            <div class="col-xs-12 col-md-4">
                                <div class="ig-container">
                                    <div class="date-time-header">Today</div>
                                    <div class="ig-subhead"><span id="day-chart-count"></span> bookings</div>
                                    <div id="ig-today" class="booking-chart-container"></div>
                                </div>
                            </div>
                            <div class="col-xs-12 col-md-4">
                                <div class="ig-container">
                                    <div class="date-time-header">This Week</div>
                                    <div class="ig-subhead"><span id="week-chart-count"></span> bookings</div>
                                    <div id="ig-week" class="booking-chart-container"></div>
                                </div>
                            </div>
                            <div class="col-xs-12 col-md-4">
                                <div class="ig-container">
                                    <div class="date-time-header">This Month</div>
                                    <div class="ig-subhead"><span id="month-chart-count"></span> bookings</div>
                                    <div id="ig-month" class="booking-chart-container"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
    
    <!-- about template modal -->
    <div class="modal fade" id="template-modal" tabindex="-1" role="dialog" aria-labelledby="template-modal-aria-title">
        <div class="modal-dialog" role="document">
            <div class="modal-content" id="template-modal-content" data-bind="component: { name: 'web-template-modal-component', params: $root }"></div>
        </div>
    </div>
    <!-- endnow modal -->
    <div class="modal fade" id="endnow-modal" tabindex="-1" role="dialog" aria-labelledby="default-aspx-endnow-modal-title">
        <div class="modal-dialog" role="document">
            <div class="modal-content" id="endnow-modal-content">
                <div class="modal-header">
                    <button id="close-endnow-button" type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h3 class="modal-title" id="default-aspx-endnow-modal-title">Are you sure you want to end this booking now?</h3>
                </div>
                <div class="modal-body">
				    <p class="date"></p>
				    <p class="event-name"></p>
				    <p class="location"></p>
			    </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" id="endBookingBtn">Yes, End Booking</button>
                    <button id="no-endnow-button" type="button" class="btn btn-primary" data-dismiss="modal">No, Don't End</button>
                </div>
            </div>
        </div>
    </div>

    <!-- booking details modal -->
    <div id="booking-details-comp" data-bind='component: { name: "booking-details-component", params: { ScreenText: {
        TimeText: "Time",
        DateText: "Date",
        EventNameText: "Event Name",
        LocationText: "Location",
        GroupNameText: "Customer Name",
        NoBookingsMessage: "No bookings exist for this event.",
        BookingDetailsText: "Booking Details",
        EventDetailsText: "Event Details",
        RelatedEventsText: "Related Events",
        DownloadIcsText: "Add to My Calendar",
        ShareText: "Share",
        CloseText: "Close",
        EditText: "edit",
        FirstBookingText: "First Booking",
        LastBookingText: "Last Booking",
        CheckedInText: "Checked In",
        CheckInText: "Check In",
        CancelText: "Cancel",
        EndNowText: "End Now",
        EndNowConfirmText: "Are you sure you want to end this booking now?",
        YesEndBookingText: "Yes, End Booking",
        NoDontEndText: "No, Don&#39;t End",
        CancelBookingQuestionText: "Cancel Booking?",
        CancelReasonText: "Cancel Reason",
        CancelNotesText: "Cancel Notes",
        YesCancelText: "Yes, Cancel Booking",
        NoCancelText: "No, Keep Booking"} } }'>
    </div>

    <!-- location details modal -->
    <div id="location-details-comp" data-bind='component: { name: "location-details-component", params: { } }'>
    </div>

    <!-- floor plan modal -->
    <div id="floorplan-component-modal" data-bind='component: { name: "floorplans-reserve-modal", params: { 
    RoomInfo: new FloorMapRoomInfo(),
    renderType: "modal",
    ScreenText: {
        RequestText: "Request    ",
        ReserveText: "Reserve    ",
        RoomDetailsText: "Room Details",
        RoomCodeText: "Room Code",
        RoomDescriptionText: "Description    ",
        RoomTypeText: "Room Type",
        AvailabilityText: "Availability    ",
        AvailableText: "Available    ",
        UnavailableText: "Unavailable    ",
        StartTimeText: "Start Time    ",
        EndTimeText: "End Time    ",
        TitleText: "Title    ",
        GroupNameText: "Customer"
} } }'>
    </div>

    <script type="text/html" id="my-reservation-templates-template">
        <!-- ko if: (DevExpress.devices.real().phone && IsMobile) || IsWebApp -->
        <div class="row" data-bind="attr: {'data-mobile': IsMobile, 'data-webapp': IsWebApp }">
            <div class="col-xs-6 ellipsis-text">
                <span data-bind="text: vems.decodeHtml(Text)"></span>
            </div>
            <div class="col-xs-6 table-buttons">
                <button type="button" class="btn btn-primary btn-xs" data-bind="event: { mousedown: $root.templateClick }">book now</button>
                <button type="button" class="btn btn-primary btn-xs" data-bind="attr: { 'data-navigateurl': NavigateUrl, 'data-templateid': Id }" data-toggle="modal" data-target="#template-modal">about</button>
            </div>
        </div>
        <!-- /ko -->
    </script>

    <script type="text/html" id="my-bookings-template">
        <div class="row">
            <div class="col-md-2 col-sm-2 col-xs-7 ellipsis-text grid-lesspad-right">
                <div class="row">
                    <div class="col-sm-12 col-xs-12">
                        <span data-bind="text: moment(ev.UserEventStart).format('LT') + ' - ' + moment(ev.UserEventEnd).format('LT')"></span>
                    </div>
                    <div class="hidden-sm hidden-md hidden-lg col-sm-12 col-xs-12 ellipsis-text">
                        <a href="#" data-bind="text: vems.decodeHtml(ev.EventName), click: function () { vems.bookingDetailsVM.show(Id, 0); }"></a>
                    </div>
                </div>
            </div>
            <div class="col-md-3 col-sm-3 hidden-xs ellipsis-text grid-lesspad">
                <a href="#" data-bind="text: vems.decodeHtml(ev.EventName), click: function () { vems.bookingDetailsVM.show(Id, 0); }, attr: {title: vems.decodeHtml(ev.EventName)}"></a>
            </div>
            <div class="col-md-2 col-sm-2 col-xs-5 grid-lesspad" style="white-space: normal; word-break: break-word;">
                <!-- ko if: ShowFloorMap && (ImageId > 0) -->
	            <a href="#" data-bind="click: vems.home.viewModels.myBookings.showMap" aria-label="Floor Map">
	                <i class="icon-ems-floorplan"></i>
	            </a>
                <!-- /ko -->
                <a href="#" data-bind="text: vems.decodeHtml(ev.Location), click: function(data){ vems.locationDetailsVM.show(data.BuildingId, data.RoomId); }, attr:{'title': vems.decodeHtml(ev.Location)}"></a>
            </div>
            <div class="col-md-1 col-sm-2 hidden-xs ellipsis-text grid-lesspad">
                <span data-bind="text: vems.decodeHtml(ev.Status), attr:{'title': vems.decodeHtml(ev.Status)}"></span>
            </div>
            <div class="col-md-4 col-sm-3 hidden-xs table-buttons grid-lesspad-left">
                <a class="btn btn-primary btn-xs" data-toggle="modal" data-bind="visible: (ev.ConferenceURL && ev.ConferenceURL.length > 0), attr: { id: 'joinskype-' + ev.Id, href: ev.ConferenceURL, target: '_blank' }">
                    Join Skype
                </a>
                <button type="button"  class="btn btn-primary btn-xs disabled" disabled="disabled" data-toggle="modal" data-bind="visible: ev.IsCheckedIn">
                    Checked In
                </button>
                <button type="button"  class="btn btn-primary btn-xs" data-toggle="modal" data-bind="visible: ev.ShowCheckinButton, click: $root.checkInToEvent.bind(ev), attr: { id: 'checkin-' + ev.Id }">
                    Check In
                </button>
                <button type="button"  class="btn btn-primary btn-xs" data-toggle="modal" data-bind="visible: ev.AllowEndNow, click: $root.endBookingNow.bind(ev), attr: { id: 'endnow-' + ev.Id }">
                    End Now
                </button>
                <!-- ko if: ev.AllowCancel -->
                <button type="button" class="btn btn-primary btn-xs" data-toggle="modal" data-bind="click: $root.cancelBooking.bind(ev), attr: { id: 'cancel-' + ev.Id }">
                    Cancel
                </button>
                <!-- /ko -->
            </div>
        </div>
    </script>



                    <div id="CallbackStatus" style="display: none; z-index: 100" class="callbackStatus">
                        <img id="LoadingImage" src="Images/Loading.gif" alt="Loading..." />
                        <span id="LoadingText">Loading...</span>
                    </div>
                </div>
            </div>
            <!-- end page-content-wrapper -->

        </div>
        <!-- end wrapper -->
    </form>

    <div class="modal fade" id="tou-modal" tabindex="-1" role="dialog" aria-labelledby="master-virtual-ems-master-tou-modal-title">
        <div class="modal-dialog" role="document">
            <div class="modal-content" id="tou-modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h3 class="modal-title" id="master-virtual-ems-master-tou-modal-title">Terms of Use</h3>
                </div>
                <div class="modal-body">
                    <div id="OnPageHelp">
	
</div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" id="tou-print-btn">Print</button>
                    <button type="button" class="btn btn-primary" id="tou-close-btn" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="actas-modal" tabindex="-1" role="dialog" aria-labelledby="master-virtual-ems-master-actas-modal-title">
        <div class="modal-dialog" role="document">
            <div class="modal-content" id="actas-modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h2 class="modal-title" id="master-virtual-ems-master-actas-modal-title">Act As</h2>
                </div>
                <div class="modal-body">
                    <!-- ko if: -1 > -1 -->
                    <div class="actas-modal-message" data-bind='attr: { "data-email" : "" }'>
                        You are currently acting as <strong></strong>. Switch back to <strong><a role='button' id='actas-stop-acting'></a></strong>.
                    </div>
                    <!-- /ko -->
                    <!-- ko ifnot: -1 > -1 -->
                    <div class="actas-modal-message">You are currently signed in as <strong></strong>.</div>
                    <!-- /ko -->
                    <div class="form-group has-feedback">
                        <label for="actas-search-input" class="hide-element">Find by name</label>
                        <input type="text" class="form-control" placeholder="Find by name" id="actas-search-input" maxlength="50" />
                        <i class="fa fa-search form-control-feedback"></i>
                    </div>
                    <div class="booking-grid" style="margin-bottom: -15px; height: 300px;">
                        <div class="modal-grid">
                            <!-- ko foreach: DelegatesSearchResults -->
                            <div class="row row-selectable" data-bind="attr: { 'data-email': vems.decodeHtml(EmailAddress()) }">
                                <div class="col-xs-6 ellipsis-text" data-bind="text: vems.decodeHtml(UserName())"></div>
                                <div class="col-xs-6 ellipsis-text"><a data-bind="text: vems.decodeHtml(EmailAddress()), attr: { href: 'mailto:' + vems.decodeHtml(EmailAddress()) }"></a></div>
                            </div>
                            <!-- /ko -->
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" id="actas-ok-btn" disabled>OK</button>
                    <button type="button" class="btn btn-primary" id="actas-cancel-btn" data-dismiss="modal">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <div id="confirmation-modal" class="modal" data-backdrop="static" tabindex="-1" role="dialog" aria-labelledby="master-virtual-ems-master-confirmation-modal-title">
        <div class="modal-dialog modal-sm">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="master-virtual-ems-master-confirmation-modal-title">Confirmation</h4>
                </div>
                <div class="modal-body"></div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="help-text-modal" tabindex="-1" role="dialog" aria-labelledby="master-virtual-ems-master-help-text-modal-title">
        <div class="modal-dialog" role="document">
            <div class="modal-content" id="help-text-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h2 class="modal-title" id="master-virtual-ems-master-help-text-modal-title">
                        <span>Help</span>
                        
                    </h2>
                </div>
                <div class="modal-body">
                    <span id="help-text-body-content"></span>
                    <div id="help-text-body-edit-content" style="display: none;">
                        <div class="row">
                            <div class="col-sm-12">
                                <div class="form-group">
                                    <label for="webtext-culture-drop" class="form-label">Language</label>
                                    <select id="webtext-culture-drop" class="form-control"></select>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-sm-12">
                                <label for="webtext-editor" class="hide-element">Edit Web Text</label>
                                <textarea id="webtext-editor" style="width: 100%; height: 300px;"></textarea>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" id="help-text-close-btn" data-dismiss="modal">OK</button>
                    <button type="button" class="btn btn-primary" id="help-text-save-btn" style="display: none;">Save Changes</button>
                    <button type="button" class="btn btn-default" id="help-text-cancel-btn" data-dismiss="modal" style="display: none;">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- bad browser alert modal -->
    <div class="modal fade" id="bad-browser-modal" tabindex="-1" role="dialog" aria-labelledby="master-virtual-ems-master-bad-browser-modal-title">
        <div class="modal-dialog" role="document">
            <div class="modal-content" id="bad-browser-modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h3 class="modal-title" id="master-virtual-ems-master-bad-browser-modal-title">Browser Support</h3>
                </div>
                <div class="modal-body">
                    <br />
                    <span class="pull-left">
                        We've noticed that you're using an older web browser. For the best experience, upgrade to the latest version of one of the browsers listed on the 
                        <a href="https://success.emssoftware.com/Content/EMS_SystemReq_44.1.html?tocpath=Installation%20Guides%7CSystem%20Requirements%7C_____1" target="_blank">system requirements page</a>.
                        <br />
                        <br />
                        <span>Note:  If you are using Internet Explorer, please also make sure that Compatibility View is disabled.</span>
                    </span>
                    <br />
                    <br />
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" id="bad-browser-btn-close" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Skype Conferencing Modal -->
    <div id="conferencing-login-modal" class="modal fade" tabindex="0" role="dialog" aria-labelledby="conferencing-login-modal-title">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div id="page-loading-overlay-skype" class="skype-logo-wrapper">
                        <img class="loading-animation" src="Images/Loading.gif" alt="Loading..." />
                    </div>
                    <div class="modal-header skype-modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close" id="conferencing-login-modal-close-icon"><span aria-hidden="true">&times;</span></button>
                        <h3 class="modal-title hide-element" id="conferencing-login-modal-title">Add Skype to Reservation</h3>
                    </div>
                    <div class="modal-body" style="white-space: pre-line; padding-top: 0px;">
                       <iframe id="conferencing-iframe" data-src="ConferencingLogin.aspx" data-conferencing-config='{
                                "method": "Native",
                                "clientID": "",
                                "tenant": "",
                                "constants": { 
                                    "NTLM" : "NTLM",
                                    "Online": "Online"
                                }
                           }'>
                       </iframe>
                    </div>
                </div>
            </div>
        </div>
</body>

<script type="text/javascript">
    var outMsg = '';
    var outMsgTitle = '';
    var menuJSON = [{"Text":"Home","NavigateUrl":"Default.aspx","Id":2147483647,"Target":null,"Selectable":false,"IconClass":"fa fa-home","IsMainMenuItem":true,"IsMobile":true,"IsWebApp":true,"ChildMenus":[]},{"Text":"Help","NavigateUrl":"","Id":33,"Target":null,"Selectable":false,"IconClass":"","IsMainMenuItem":false,"IsMobile":false,"IsWebApp":true,"ChildMenus":[{"Text":"About","NavigateUrl":"About.aspx","Id":-36,"Target":null,"Selectable":true,"IconClass":"","IsMainMenuItem":false,"IsMobile":false,"IsWebApp":true,"ChildMenus":[]},{"Text":"User Manual","NavigateUrl":"https://success.emssoftware.com/Content/UserGuides/3_EMSWebAppV44.1_UG.htm?tocpath=User%20Guides%7CEMS%20Web%20App%20%7C_____0?data=Yx22vViF5q1LUofOTneSVtLyHH0UmUjA%2bg4fBRh2%2bBTYybV%2fjKPJ%2b0kL9F6nOmXf6xHm4eltRkI%3d","Id":-34,"Target":"_blank","Selectable":true,"IconClass":"","IsMainMenuItem":false,"IsMobile":false,"IsWebApp":true,"ChildMenus":[]}]},{"Text":"Sign In","NavigateUrl":"Default.aspx","Id":10,"Target":null,"Selectable":true,"IconClass":"","IsMainMenuItem":false,"IsMobile":false,"IsWebApp":true,"ChildMenus":[]},{"Text":"Create A Request","NavigateUrl":"/EmsWebApp/ClassicRequestForm.aspx?data=ity3Dem%2byxxGFZTQvNr975K4dCU8QwV7","Id":37,"Target":null,"Selectable":true,"IconClass":"fa-calendar-plus-o","IsMainMenuItem":true,"IsMobile":false,"IsWebApp":true,"ChildMenus":[]},{"Text":"Browse","NavigateUrl":"","Id":1,"Target":null,"Selectable":false,"IconClass":"fa-search","IsMainMenuItem":true,"IsMobile":false,"IsWebApp":true,"ChildMenus":[{"Text":"Events","NavigateUrl":"BrowseEvents.aspx","Id":-5,"Target":null,"Selectable":true,"IconClass":"fa-bookmark","IsMainMenuItem":true,"IsMobile":false,"IsWebApp":true,"ChildMenus":[]},{"Text":"Locations","NavigateUrl":"BrowseForSpace.aspx","Id":-23,"Target":null,"Selectable":true,"IconClass":"fa-map-marker","IsMainMenuItem":true,"IsMobile":false,"IsWebApp":true,"ChildMenus":[]}]},{"Text":"Links","NavigateUrl":"","Id":4,"Target":null,"Selectable":false,"IconClass":"fa-external-link-square","IsMainMenuItem":true,"IsMobile":false,"IsWebApp":true,"ChildMenus":[{"Text":"Attendee Roster","NavigateUrl":"https://www.angelo.edu/content/files/27602-event-attendee-roster","Id":1,"Target":"_blank","Selectable":true,"IconClass":"","IsMainMenuItem":true,"IsMobile":false,"IsWebApp":true,"ChildMenus":[]},{"Text":"ASU Reservations Quick Reference Sheet","NavigateUrl":"http://www.angelo.edu/content/files/16042-reservation-quick-guide","Id":14,"Target":"_blank","Selectable":true,"IconClass":"","IsMainMenuItem":true,"IsMobile":false,"IsWebApp":true,"ChildMenus":[]},{"Text":"Special Events Home Page","NavigateUrl":"http://www.angelo.edu/services/specialevents/index.html","Id":6,"Target":"_blank","Selectable":true,"IconClass":"","IsMainMenuItem":true,"IsMobile":false,"IsWebApp":true,"ChildMenus":[]},{"Text":"Scheduling Staff Contact Information","NavigateUrl":"http://www.angelo.edu/services/specialevents/dept_contact.html","Id":12,"Target":"_blank","Selectable":true,"IconClass":"","IsMainMenuItem":true,"IsMobile":false,"IsWebApp":true,"ChildMenus":[]},{"Text":"Policies and Guidelines","NavigateUrl":"https://www.angelo.edu/live/files/15996-policies-amp-guidelines","Id":10,"Target":"_blank","Selectable":true,"IconClass":"","IsMainMenuItem":true,"IsMobile":false,"IsWebApp":true,"ChildMenus":[]},{"Text":"Special Events Brochure","NavigateUrl":"http://www.angelo.edu/content/files/16048-info-handout","Id":11,"Target":"_blank","Selectable":true,"IconClass":"","IsMainMenuItem":true,"IsMobile":false,"IsWebApp":true,"ChildMenus":[]},{"Text":"University Center Floor Plan","NavigateUrl":"http://www.angelo.edu/content/files/15277-uc-floor-plan-pdf","Id":15,"Target":"_blank","Selectable":true,"IconClass":"","IsMainMenuItem":true,"IsMobile":false,"IsWebApp":true,"ChildMenus":[]},{"Text":"Facilities Fee Waiver Form","NavigateUrl":"https://angelostate.na2.adobesign.com/public/esignWidget?wid=CBFCIBAA3AAABLblqZhB3erBL4jO8cDcBvdIBPccQnEkn3xyr5MiQt9R2xmqLl5Gk8kckJ28GS0OR1cnA9d8*","Id":4,"Target":"_blank","Selectable":true,"IconClass":"","IsMainMenuItem":true,"IsMobile":false,"IsWebApp":true,"ChildMenus":[]},{"Text":"Chartwells Catering Service","NavigateUrl":"https://new.dineoncampus.com/Angelo/catering-information","Id":2,"Target":"_blank","Selectable":true,"IconClass":"","IsMainMenuItem":true,"IsMobile":false,"IsWebApp":true,"ChildMenus":[]},{"Text":"Alcohol Request Form","NavigateUrl":"https://angelostate.na2.adobesign.com/public/esignWidget?wid=CBFCIBAA3AAABLblqZhCBV-48mb2E-GxCe_eFGvOEz5rR8Fcs8cfVQT9HbTbpWZ_TDea45mAYq6ggWixxIjU*&hosted=false","Id":3,"Target":"_blank","Selectable":true,"IconClass":"","IsMainMenuItem":true,"IsMobile":false,"IsWebApp":true,"ChildMenus":[]},{"Text":"Solicitation Request Form","NavigateUrl":"https://www.angelo.edu/content/forms/383-solicitationsales-request?preview=1","Id":9,"Target":"_blank","Selectable":true,"IconClass":"","IsMainMenuItem":true,"IsMobile":false,"IsWebApp":true,"ChildMenus":[]},{"Text":"TULIP Insurance Policy Instructions","NavigateUrl":"https://www.angelo.edu/content/files/26786-tulip-instructions","Id":7,"Target":"_blank","Selectable":true,"IconClass":"","IsMainMenuItem":true,"IsMobile":false,"IsWebApp":true,"ChildMenus":[]},{"Text":"TULIP Insurance Policy Webpage","NavigateUrl":"https://tulip.ajgrms.com/","Id":8,"Target":"_blank","Selectable":true,"IconClass":"","IsMainMenuItem":true,"IsMobile":false,"IsWebApp":true,"ChildMenus":[]},{"Text":"TULIP Insurance Policy Brochure","NavigateUrl":"https://tulip.ajgrms.com/Content/Brochures/URMIA_TULIP_Special_Events_Brochure.pdf","Id":16,"Target":"_blank","Selectable":true,"IconClass":"","IsMainMenuItem":true,"IsMobile":false,"IsWebApp":true,"ChildMenus":[]}]}];
    var showAuthUserMenu = "".length > 0;
    var showGuestUserMenu = true && "".length === 0;
    var showActAs = false;
</script>
<script type="text/html" id="myEventTemplate">
    <div class="event-date lbl-secondary" data-bind="text: $root.buildMyRequestDateHeader(Date), attr: {'data-date': Date}"></div>
    <div data-bind="foreach: { data: Events, as: 'ev', afterRender: $root.animateEvent } ">
        <div class="event-item" data-bind="event: { mousedown: $root.eventClickStart, mouseup: $root.eventClickEnd, mouseover: $root.showDrawer, mouseout: $root.hideDrawer }">
            <!-- data-bind="event: { mousedown: $root.eventClickStart, mouseup: $root.eventClickEnd }"> -->
            <div class="event-item-color" data-bind="style: { backgroundColor: ev.Color } "></div>
            <div class="event-item-name" data-bind="text: vems.decodeHtml(ev.EventName)"></div>
            <div class="event-item-time" data-bind="text: moment(ev.EventStart).format('LT') + ' - ' + moment(ev.EventEnd).format('LT') "></div>
            <div class="event-item-location">
                <div class="float" data-bind="text: vems.decodeHtml(ev.Building)"></div>
                <div class="float">- </div>
                <div class="float" style="font-weight: bold;" data-bind="text: vems.decodeHtml(ev.Room)"></div>
            </div>
            <div class="event-item-status" data-bind="text: ev.Status"></div>
            <div class="drawer-container">
                <div class="drawer-actions">
                    <div class="drawer-eventname">
                        <span data-bind="html: vems.decodeHtml(ev.EventName)"></span>
                        <!-- ko if: ev.AllowEndNow -->
                        <a class="drawer-action-item action-endnow" data-bind="event: { click: $root.endNow }">End Now</a>
                        <!-- /ko -->
                    </div>
                    <div class="drawer-buttons">
                        <!-- ko if: ev.ShowCheckinButton -->
                        <a class="drawer-action-item action-checkin" data-bind="event: { click: $root.checkIn }, checkinAnchorText: ev.IsCheckedIn"><span class="text"></span><i style="margin-left: 4px;" class="fa fa-check-circle"></i></a>
                        <!-- /ko -->
                        <!-- ko if: ev.AllowCancel -->
                        <a class="drawer-action-item action-cancel" data-bind="event: { click: $root.cancel }">Cancel <i class="fa fa-trash"></i></a>
                        <!-- /ko -->
                        <a class="drawer-action-item" data-bind="event: { click: $root.goToSummary }">More <i class="fa fa-external-link-square"></i></a>
                    </div>
                </div>
            </div>
            <div class="drawer-overlay"></div>
        </div>
    </div>
</script>
<script type="text/html" id="menuTemplate">
    
    <!-- ko if: item.NavigateUrl.length > 0 && item.ChildMenus.length > 0  -->
    <a class="menu-item vems-slide" data-bind="css: { 'menu-first-level' : item.Id > 0 }, attr: {'data-is-parent': $data.ChildMenus.length > 0, 'href': $data.NavigateUrl, 'target': $data.Target !== null ? $data.Target : '_self' }">
        <span data-bind="html: item.Text, css: {'parent-link': item.ChildMenus.length > 0}, attr: {'href': $data.NavigateUrl.length > 0 ? $data.NavigateUrl : '#', 'target': $data.Target !== null ? $data.Target : '_self' }"></span>
        <div style="float: right;">
            <span class="menu-item-spacer">&nbsp;</span>
            <div class="arrow-container"><i data-bind="css: { 'right-arrow fa fa-angle-down fa-3 vems-transition-all': item.ChildMenus.length > 0}"></i></div>
        </div>
    </a>
    <!-- /ko -->
    <!-- ko if: item.NavigateUrl.length == 0  -->
    <div class="menu-item vems-slide" data-bind="css: { 'menu-first-level' : item.Id > 0 }, attr: {'data-is-parent': $data.ChildMenus.length > 0 }">
        <span data-bind="html: item.Text, css: {'parent-link': item.ChildMenus.length > 0}"></span>
        <div style="float: right;">
            <span class="menu-item-spacer">&nbsp;</span>
            <div class="arrow-container"><i data-bind="css: { 'right-arrow fa fa-angle-down fa-3 vems-transition-all': item.ChildMenus.length > 0}"></i></div>
        </div>
    </div>
    <!-- /ko -->
    <!-- ko if: item.NavigateUrl.length > 0 && item.ChildMenus.length == 0 -->
    <a class="menu-item vems-slide" data-bind="css: { 'menu-first-level' : item.Id > 0 }, attr: { 'href': $data.NavigateUrl, 'target': $data.Target !== null ? $data.Target : '_self' }">
        <span data-bind="html: item.Text"></span>
        
    </a>
    <!-- /ko -->
    <div class="menu-next-level vems-simple-slide" data-bind="template: { name: 'menuTemplate', foreach: ChildMenus, as: 'item'}" />
    <!-- ko if: $index() == 0 && !$parentContext.$index && $root.isAuthenticatedUser -->
    <div data-bind="css: { 'menu-item-mobile-only menu-item menu-first-level vems-slide': $index() == 0 }, attr: {'style'" data-mobile-view-requests="true">
        <span>Upcoming Events</span>
        
    </div>
    <!-- /ko -->
</script>
<script type="text/html" id="topMenuTemplate">
    <a class="menu-item menu-user-menu-item" data-bind="attr: { href: NavigateUrl, target: Target !== null ? Target : '_self' }">
        <span data-bind="html: Text"></span>
    </a>
</script>
<script type="text/html" id="cancelPopupTemplate">
    <div class="cancel-reason">
        <div class="cancel-left">
            <span class="cancel-label">Reason:</span>
        </div>
        <div class="cancel-right">
            <div id="cancelReason"></div>
        </div>
    </div>
    <br />
    <div class="cancel-notes">
        <div class="cancel-left">
            <span class="cancel-label">Notes:</span>
        </div>
        <div class="cancel-right">
            <div id="cancelNotes"></div>
        </div>
    </div>
</script>
<script type="text/javascript">
    var browserLang = window.navigator.languages || [window.navigator.language || window.navigator.userLanguage];
    var locale = vems.userLanguage.length > 0 ? vems.userLanguage : browserLang[0];
    moment.locale(locale);
    var showBadBrowserAlert = false && !DevExpress.devices.real().phone;

    var mobileLogo = 'customlogo.png';

    vems.screenText.checkinText = 'Check In';
    vems.screenText.checkOutText = 'Check Out';
    vems.screenText.checkedInText = 'Checked In';
    vems.screenText.endNowConfirmPrompt = 'Are you sure you want to end this booking now?';
    vems.screenText.endNowConfirmationMessage = 'The {0} booking has been ended.';
    vems.screenText.cancelNotesRequiredMessage = 'You must enter Cancel Notes';
    vems.screenText.cancelSuccessMessage = 'The {0} booking was cancelled.';
    vems.screenText.StillWorkingText = 'Still Working?';
    vems.screenText.KeepWorkingText = 'Keep Working';
    vems.screenText.SignOutText = 'Sign Out';
    vems.screenText.termsOfUseText = 'Terms of Use';
    
    vems.typeAheadDelay = 400;

    $('#actas-modal').on('show.bs.modal', function (event) {
        vems.actAsModalShowing(event);
    });

    $('#tou-modal').on('show.bs.modal', function (event) {
        vems.touModalShowing(event);
    });
    
    $(document).ready(function () {
        // when using a phone, convert tabs to vertical format and disable 'home' link on logo
        if (DevExpress.devices.real().phone) {
            vems.convertTabsForMobile();
            $('.ems-logo-link').removeAttr('href');  // link disabled to prevent accidental usage while activating hamburger menu
        }

        // set initial local storage value to update auth status and sync session timeout b/w tabs
        localStorage.setItem(vems.sessionConsts.isAuthed, !!vems.isAuthed);

        // if the current user is authenticated, begin session-timeout countdown logic
        if (vems.isAuthed) {
            var timeoutUrl = 'Default.aspx?data=5BtDNigiZmY1BdgfFAPGfTaK8CR4hDLJC1mz0OZPUAQ%3d';  // used when session timeout countdown expires
            var logoutUrl = 'Logout.aspx';  // used when 'sign out' button clicked (override logic handled in logout page code-behind)

            // bind 'storage' event to listen for changes (used to sync session timeout b/w tabs)
            vems.bindLocalStorageListeners(timeoutUrl);

            var timeoutCounter = 0;  // number of seconds elapsed since timeout modal was shown
            var countdownSeconds = 60;  // total number of seconds allowed until auto-logout happens
            vems.activeSessionTimer = vems.sessionTimer({
                minutes: parseInt(20) - Math.ceil(countdownSeconds / 60),  // subtract minute(s) to allow for full countdown before session expiration
                onTimerEnd: function () {
                    // prevent auto-refresh (on home page) when timeout popup appears
                    if (typeof vems.autoRefresh !== 'undefined') {
                        clearInterval(vems.autoRefresh);
                    }

                    // since session timer has ended, generate and display timeout countdown modal
                    var extendSession = function () {
                        clearTimeout(expirationTimer);
                        vems.activeSessionTimer.resetTimer();
                    };
                    var endSession = function () {
                        clearTimeout(expirationTimer);
                        window.location = logoutUrl;
                    };
                    var timeoutModal = vems.showModalMessageWithButtons('Your EMS Web App session is about to end.  Would you like to keep working, or sign out?<div class=\"accented-text\">If you do nothing, you will be signed out automatically in <b><span class=\"countdown\"></span></b> seconds.</div>',  // message
                        vems.screenText.StillWorkingText,  // title
                        vems.screenText.KeepWorkingText,  // action button text
                        vems.screenText.SignOutText,  // cancel button text
                        extendSession,  // action button click event ('keep working')
                        endSession,  // cancel button click event ('sign out')
                        extendSession);  // clicking outside modal event (assume 'keep working' preferred)

                    // display seconds left in countdown (updated every 1000ms)
                    var countdownDisplaySpan = $(timeoutModal).find('.countdown');
                    countdownDisplaySpan.html(countdownSeconds);
                    timeoutCounter = 0;
                    var expirationTimer = setInterval(function () {
                        timeoutCounter++;
                        countdownDisplaySpan.html(countdownSeconds - timeoutCounter);

                        // if countdown has finished, end the countdown and redirect to configured login page
                        if (timeoutCounter === countdownSeconds) {
                            clearInterval(expirationTimer);
                            window.location = timeoutUrl;
                        }
                    }, 1000);
                }
            });
            vems.activeSessionTimer.startTimer();  // start timer after initialization
        }

        (function () {
            var isMobile = {
                Android: function() {
                    return /Android/i.test(navigator.userAgent);
                },
                iOS: function() {
                    return /iPhone|iPad|iPod/i.test(navigator.userAgent);
                }
            };

            var mobileBannerDismissed = moment().diff(moment(vems.encodeHtml(localStorage.getItem('emsMobileBannerDismissed'))), 'days') < 30;       
            if (((isMobile.Android() && 'https://play.google.com/store/apps'.length) || (isMobile.iOS() && 'https://appstore.com'.length)) && !mobileBannerDismissed) {
                $('#page-content-wrapper').css('padding-bottom', '20%');
                $('#showMobile').removeClass('hidden');

                // move all web app content down to accomodate app promo banner
                $('#vems-navbar-top').css('top', '80px');
                $('#page-content-wrapper').css('top', '143px');
                $('#sidebar-wrapper').css('top', '143px');
            } 

            if (isMobile.Android()) {
                $('#launchMobile').attr('href', 'https\x3a\x2f\x2fplay.google.com\x2fstore\x2fapps');
            } else if (isMobile.iOS()) {
                $('#launchMobile').attr('href', 'https\x3a\x2f\x2fappstore.com');
            }

            $('#dismissMobile').on('click', function(item){
                localStorage.setItem('emsMobileBannerDismissed', moment().format('YYYY-MM-DDTHH:mm:ss'));
                $('#showMobile').hide();
                $('#page-content-wrapper').css('padding-bottom', '0');

                // move all web app content back up
                $('#vems-navbar-top').css('top', '0');
                $('#page-content-wrapper').css('top', 'auto');
                $('#sidebar-wrapper').css('top', 'auto');
            });

            function goToUri(uri, href) {
                var start, end, elapsed;
                start = new Date().getTime();

                if(isMobile.iOS()) document.location = uri;
                if(isMobile.Android()) document.location.replace(uri);

                // end timer
                end = new Date().getTime();
                elapsed = (end - start);

                if (elapsed < 1) {
                    document.location = href;
                }
            }

            $('a.intent').on('click', function (event) {
                goToUri($(this).data('scheme'), $(this).attr('href'));
                event.preventDefault();
            });
        })();

        if (showBadBrowserAlert) {
            $('#bad-browser-modal').modal('show');
        }

        $('#conferencing-login-modal').one('show.bs.modal', function (e) {
            var config = $('#conferencing-iframe').data('conferencing-config');
            $('#conferencing-iframe').prop('src', $('#conferencing-iframe').data('src'));
            $('#conferencing-iframe').css("height", config.method !== "Native" ? "260" : "390");
        });

        // initialize any numeric input events required for the current page
        var jqDocObj = $(document);
        vems.initNumericAttendanceInputs(jqDocObj);
        vems.initNumericUdfInputs(jqDocObj);
        vems.initNumericKoBinding();

        // conditionally load addthis js based on parameter setting
        if ('true' === 'true') {
            var head = document.getElementsByTagName('head')[0];
            var script = document.createElement('script');
            script.src = '//s7.addthis.com/js/300/addthis_widget.js';
            script.type = 'text/javascript';
            head.appendChild(script);
        }
    });
</script>
    
    <script src="/EmsWebApp/bundles/booking-details?v=uFValRGNpL1Ez5BBFfRBg0iwjJox_ODU2q-bbjMtRpA1"></script>

    <script src="/EmsWebApp/bundles/location-details-component?v=jQC5cQzirWTB5YCZeJLTDuskfDs7GOflhYz__cglTOs1"></script>

    <script type="text/javascript">
        vems.eventCountsForMonth = {"ReservedLabel":null,"CancelledLabel":null,"RequestedLabel":null,"ConflictingLabel":null,"EventCounts":[]};
        vems.webTemplates =  [];
        vems.autoRefreshBookings =  false;
        vems.autoRefreshInterval =  60000;
        vems.showInfographics = false;
        vems.enableShowMyBookingsButton = false;
        vems.noBookingsForDate = 'There are no bookings for {0}';
        vems.screenText.Result = 'Result.';
        vems.screenText.Results = 'Results.';
        vems.screenText.NoSearchResults = 'Nothing was found for \"{0}\".';
        var sSignInJson = '{"ShowCreateAccountButton":true,"AllowSignIn":true,"AccountButtonText":"Request An Account","RequestRoomText":"Request A Room","AllowUnauthenticatedRequest":true,"DefaultTab":0,"DefaultTabUnauthenticated":0}';
        vems.home.viewModels.signin = {};

        var FloorMapHash = '';
        var FloorMapWebServiceUrl = '';

        var showSiteHome = $('.default-page-help-text-content').text().trim().length == 0;
        if (showSiteHome) {
            $('#site-home-tab').remove();
        }

        if(typeof(loadAsLogin) != "undefined" && loadAsLogin){
            vems.isAuthed = false;
        }

        if (vems.isAuthed) {           
            if (DevExpress.devices.real().phone) {
                $('#default-tablist').hide();
                $('#my-reservations > h2').hide();

                $('#my-bookings-title a').attr('data-bind', '');
                $('#my-bookings-title a').text('My Bookings');

                $('#page-title-responsive').append($("<a href='RoomRequest.aspx' id='new-booking'><i class='fa fa-plus' style='padding-right: 9px;'></i>" + 'New Booking' + "</a>"));

                $('#my-bookings-tabs, .previous-today-next').hide();
                $('#sliderContainer').calendarScroller({
                    startDate: moment(),
                    eventDates: [],    //[new Date(2016, 0, 20), new Date(2016, 0, 22)],
                    dateSelected: function (date) {
                        getEventsForDay(moment(date));
                    }
                });
            } else if (vems.enableShowMyBookingsButton) {  // 'else' used because this section doesn't exist on a phone
                $('#my-reservations-overlay').show();  // covers/hides 'my bookings' section by default when parameter is enabled
            }

            $("#my-home-content").show();
        } else {
            $("#signin-panel").show();
        }

        $('#template-modal').on('show.bs.modal', function(event) {
            vems.templateModalShowing(event);
        });

        $('#my-bookings-tabs').on('show.bs.tab', function(event) {
            var tabType = $(event.target).parent().data('tabtype');

            if (tabType === 'day') {
                vems.home.viewModels.myBookings.localeDate(vems.home.viewModels.myBookings.currentDailyDate.format('LL'));
            } else if (tabType === 'month') {
                $('#bookings-monthly-calendar').data('dxCalendar').option('value', vems.home.viewModels.myBookings.currentDailyDate._d);
                vems.home.viewModels.myBookings.localeDate(moment($('#bookings-monthly-calendar').data('dxCalendar').option('value')).format('MMMM YYYY'));
            }
        });

        $("body").on('keypress', '#booking-search-box', function(e){
            if(e.which == 13){
                ko.dataFor($('#booking-search-box')[0]).searchForBookings();
                return false;
            }
        });

        $(document).ready(function () {  
            if(false)
                vems.showToasterMessage('', '', 'success', 2000);

            ko.mapping.fromJSON(sSignInJson, {}, vems.home.viewModels.signin);
            ko.applyBindings(vems.home.viewModels.signin, $('#signin-panel')[0]);
            vems.home.viewModels.templates = new vems.home.templateVM();
            ko.applyBindings(vems.home.viewModels.templates, $('#my-reservation-templates')[0]);

            var defaultTabId = vems.isAuthed ? vems.home.viewModels.signin.DefaultTab() : vems.home.viewModels.signin.DefaultTabUnauthenticated();

            if (defaultTabId === 0 || showSiteHome || DevExpress.devices.real().phone) {
                $('#my-home-tab').addClass('active');
                $('#my-home').addClass('in active');
            } else {
                $('#site-home-tab').addClass('active');
                $('#site-home').addClass('in active');
            }

            if(vems.home.viewModels.templates.templates().length === 0){
                $('#templates-no-results').show();
                $('#templates-grid').hide();
            }

            vems.home.bookingCounts = vems.eventCountsForMonth;
            vems.home.buildCalendar();
            
            vems.home.viewModels.myBookings = new vems.home.myBookingsVM();
            ko.applyBindings(vems.home.viewModels.myBookings, $('#my-reservations')[0]);
            
            ko.applyBindings(null, $('#booking-details-comp')[0]);
            ko.applyBindings(null, $('#location-details-comp')[0]);
            ko.applyBindings(null, $('#floorplan-component-modal')[0]);

            vems.home.buildDatePicker();
            if (vems.showInfographics && !DevExpress.devices.real().phone) {
                vems.home.buildEventPieChart($('#ig-today'), 'day');
                vems.home.buildEventPieChart($('#ig-week'), 'week');
                vems.home.buildEventPieChart($('#ig-month'), 'month');
                $('#my-infographics').show();
            }

            ko.applyBindings(null, $('#conf-msg')[0]);  // allow if/ifnot bindings to work for confirmation messages
            $('#conf-msg').show();  // supplements functionality to prevent temporary showing of messages while page loading

            if (vems.isAuthed && vems.autoRefreshBookings) {  // refresh booking list every X milliseconds if applicable (minimum 60000)
                vems.autoRefresh = setInterval(function () { getEventsForDay(vems.home.viewModels.myBookings.currentDailyDate); }, vems.autoRefreshInterval);
            }

            setTimeout(function(){
                // the pie charts can end up sized outside their container so we call render for them to fix themselves.
                if($('#ig-today').data('dxPieChart'))
                    $('#ig-today').data('dxPieChart').render();

                if($('#ig-week').data('dxPieChart'))
                    $('#ig-week').data('dxPieChart').render();

                if($('#ig-month').data('dxPieChart'))
                    $('#ig-month').data('dxPieChart').render();
            }, 100);
        });

        /* login logic */
        function validatePage() {

        }

        $(document).ready(function () {
            if(Dea.loginOverrideUrl && Dea.loginOverrideUrl.length > 0){
                $('#login-sso-div').show();
            }else{
                $('#login-standard-div').show();
            }

            $(".userId").attr('name','userID_input');
            $(".userId").attr('ID','userID_input');
            
            var loginValidation = {
                //debug: true,
                rules: {
                    "userID_input": {required: true },
                    "password_input": {required: true },                   
                },
                messages: {
                    "userID_input": {required: "Please type a valid user id."},
                    "password_input": {required:"Please type a valid password."},
                },
                submitHandler: function (form) {
                    var escaped = vems.htmlEncode($("#password_input").val());
                    $("#pwdhid").val(escaped);
                    $("#password_input").val('');  //clear out pw
                    form.submit();
                }
            };
            jQuery.extend(loginValidation, vems.validationClasses);
            var validator = $("#VirtualEmsForm").validate(loginValidation);

            if ($('#userID_input').val().length > 0) {
                $("#password_input").focus();
            } else {
                $('#userID_input').focus();
            }

            if ('false' === 'true') {
                $("#timeoutMsg").show();
            }

            //$('#password_input').attr('autocomplete', 'off');

        });
        /* end of login logic*/
    </script>

    <asp:contentplaceholder>
        
    </asp:contentplaceholder>
</html>
